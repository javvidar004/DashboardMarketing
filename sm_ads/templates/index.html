
{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">

    <title>Main page</title>

    <!-- Bootstrap core CSS -->
    <link href="{% static 'assets/css/bootstrap.css' %}" rel="stylesheet">
    <!--external css-->
    <link href="{% static 'assets/font-awesome/css/font-awesome.css' %}" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="{% static 'assets/css/zabuto_calendar.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'assets/js/gritter/css/jquery.gritter.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'assets/lineicons/style.css' %}">    
    
    <!-- Custom styles for this template -->
    <link href="{% static 'assets/css/style.css' %}" rel="stylesheet">
    <link href="{% static 'assets/css/style-responsive.css' %}" rel="stylesheet">

    <script src="{% static 'assets/js/chart-master/Chart.js' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

  <section id="container" >
      <!-- **********************************************************************************************************************************************************
      TOP BAR CONTENT & NOTIFICATIONS
      *********************************************************************************************************************************************************** -->
      <!--header start-->
      <header class="header black-bg">
              <div class="sidebar-toggle-box">
                  <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
              </div>
            <!--logo start-->
            <a href="{% url 'main' %}" class="logo"><b>MARKETING DASHBOARD</b></a>
            <!--logo end-->
            <div class="top-menu">
            </div>
        </header>
      <!--header end-->
      
      <!-- **********************************************************************************************************************************************************
      MAIN SIDEBAR MENU
      *********************************************************************************************************************************************************** -->
      <!--sidebar start-->
      <aside>
          <div id="sidebar"  class="nav-collapse ">
              <!-- sidebar menu start-->
              <ul class="sidebar-menu" id="nav-accordion">	
                  <li class="mt">
                      <a class="active" href="{% url 'main' %}">
                          <i class="fa fa-dashboard"></i>
                          <span>Main Dashboard</span>
                      </a>
                  </li>

                  <li class="sub-menu">
                      <a href="javascript:;" >
                          <i class="fa fa-desktop"></i>
                          <span>Social Media Platforms</span>
                      </a>
                      <ul class="sub">
                        {% for x in redesSociales %}
                            <!--<li><a href="../smp/{{ x.socialm_id }}">{{ x.socialm_name }}</a></li>-->
                            <li><a href="{% url 'detailPlatform' x.socialm_id %}">{{ x.socialm_name }}</a></li>
                        {% endfor %}
                      </ul>
                  </li>

                  <li class="sub-menu">
                      <a href="javascript:;" >
                          <i class="fa fa-cloud"></i>
                          <span>Countries</span>
                      </a>
                      <ul class="sub">
                        {% for x in paises %}
                            <li><a href="{% url 'detailContry' x.country_id %}">{{ x.country_name }}</a></li>
                        {% endfor %}
                      </ul>
                  </li>
                  <li class="sub-menu">
                      <a href="javascript:;" >
                          <i class="fa fa-book"></i>
                          <span>Genders</span>
                      </a>
                      <ul class="sub">
                        {% for x in generos %}
                          <li><a href="{% url 'detailGender' x.gender_id %}">{{ x.gender }}</a></li>
                        {% endfor %}
                      </ul>
                  </li>
                  <li class="sub-menu">
                      <a href="javascript:;" >
                          <i class="fa fa-tasks"></i>
                          <span>Entertainment</span>
                      </a>
                      <ul class="sub">
                        {% for x in tipoEntretenimiento %}
                          <li><a href="{% url 'detailEntertainment' x.entertainment_id %}">{{ x.entertainment_name }}</a></li>
                        {% endfor %}
                      </ul>
                  </li>
              </ul><!-- sidebar menu end-->
          </div>
      </aside><!--sidebar end-->
      
      <!-- **********************************************************************************************************************************************************
      MAIN CONTENT
      *********************************************************************************************************************************************************** -->
      <!--main content start-->
      <section id="main-content">
          <section class="wrapper">

            <div class="row">

              <div class="col-md-2">
                  <div class="card text-center">
                      <div class="card-body">
                          <i class="fa fa-users fa-2x mb-2"></i>
                          <h3>{{ total_users }}</h3>
                          <p>Total de usuarios entrevistados</p>
                      </div>
                  </div>
              </div>
          
              <div class="col-md-2">
                  <div class="card text-center">
                      <div class="card-body">
                          <i class="fa fa-user fa-2x mb-2"></i>
                          <h3>{{ avg_age }}</h3>
                          <p>Edad promedio</p>
                      </div>
                  </div>
              </div>
          
              <div class="col-md-2">
                  <div class="card text-center">
                      <div class="card-body">
                          <i class="fa fa-instagram fa-2x mb-2"></i> 
                          <h5>{{ top_social_media }}</h5>
                          <p>Plataforma más usada</p>
                      </div>
                  </div>
              </div>
          
              <div class="col-md-2">
                  <div class="card text-center">
                      <div class="card-body">
                          <i class="fa fa-money fa-2x mb-2"></i>
                          <h3>${{ avg_income }}</h3>
                          <p>Ingreso mensual promedio</p>
                      </div>
                  </div>
              </div>
          
              <div class="col-md-2">
                  <div class="card text-center">
                      <div class="card-body">
                          <i class="fa fa-flag fa-2x mb-2"></i>
                          <h5>{{ top_country }}</h5>
                          <p>País con más usuarios</p>
                      </div>
                  </div>
              </div>
          
              <div class="col-md-2">
                  <div class="card text-center">
                      <div class="card-body">
                          <i class="fa fa-mobile fa-2x mb-2"></i>
                          <h5>{{ top_device }}</h5>
                          <p>Dispositivo más usado</p>
                      </div>
                  </div>
              </div>
          
          </div>
              
                  
                      
                      <div class="row mt">
                      <!-- SERVER STATUS PANELS -->
                      	<div class="col-md-4 col-sm-4 mb" style="height: 500px;">
                      		<div class="white-panel" style="height: 500px;">
                      			<div class="white-header">
						  			<h5>USUARIOS ENTREVISTADOS POR REGIÓN</h5>
                      			</div>
								<div class="row">

	                      		</div>
								<!-- <canvas id="serverstatus01" height="120" width="120"></canvas> -->
                                <canvas id="countryChart" style="width: 100%; height: 400px;"></canvas>
                                <script>
                                fetch("{% url 'users_by_country' %}")
                                  .then(response => response.json())
                                  .then(data => {
                                    const ctx = document.getElementById('countryChart').getContext('2d');
                                    new Chart(ctx, {
                                      type: 'bar',
                                      data: {
                                        labels: data.labels,
                                        datasets: [{
                                          label: 'Usuarios evaluados por país',
                                          data: data.data,
                                          backgroundColor: 'rgba(75, 192, 192, 0.7)',
                                          borderColor: 'rgba(75, 192, 192, 1)',
                                          borderWidth: 1
                                        }]
                                      },
                                      options: {
                                        responsive: true,
                                        scales: {
                                          y: {
                                            beginAtZero: true

                                          }
                                        }
                                      }
                                    });
                                  });
                                </script>
	                      	</div><!-- /grey-panel -->
                      	</div><!-- /col-md-4-->
                      	

                      	<div class="col-md-4 col-sm-4 mb" style="height: 500px;">
                      		<div class="white-panel" style="height: 500px;">
                      			<div class="white-header">
						  			<h5>USO DE DISPOSITIVOS</h5>
                      			</div>
                                  <div class="row">
                                    <div class="chart-container" style="display: flex; justify-content: center; align-items: center;">
                                        <canvas id="deviceChart"></canvas>
                                    </div>
                                
                                    <script>
                                    fetch("{% url 'devices_for_social_media' %}")
                                      .then(res => res.json())
                                      .then(data => {
                                        new Chart(document.getElementById('deviceChart'), {
                                          type: 'pie',
                                          data: {
                                            labels: data.labels,
                                            datasets: [{
                                              label: 'Dispositivos para redes sociales',
                                              data: data.data,
                                              backgroundColor: ['#f39c12', '#e74c3c', '#8e44ad', '#3498db']
                                            }]
                                            },
                                        });
                                      });
                                    </script>
                                </div>

                      		</div>
                      	</div><!-- /col-md-4 -->
                      	
                          <div class="col-md-4 col-sm-4 mb" style="height: 500px;">
							<!-- WHITE PANEL - TOP USER -->
							<div class="white-panel" style="height: 500px;">
								<div class="white-header">
									<h5>TOP USER</h5>
								</div>
								<p><b>Zac Snider</b></p>
								<div class="row">
                                    <canvas id="genderChart"></canvas>
                                    <script>
                                    fetch("{% url 'gender_distribution' %}")
                                      .then(res => res.json())
                                      .then(data => {
                                        new Chart(document.getElementById('genderChart'), {
                                          type: 'doughnut',
                                          data: {
                                            labels: data.labels,
                                            datasets: [{
                                              label: 'Distribución de género',
                                              data: data.data,
                                              backgroundColor: ['#2980b9', '#e67e22', '#2ecc71']
                                            }]
                                          }
                                        });
                                      });
                                    </script>
								</div>
							</div>
						</div><!-- /col-md-4 -->
                      	

                    </div><!-- /row -->
                    
                    				
					<div class="row">
						<!-- TWITTER PANEL -->
						<div class="col-md-4 mb">
                      		<div class="darkblue-panel pn">
                      			<div class="darkblue-header">
						  			<h5>OCUPACIONES PRINCIPALES</h5>
                      			</div>
                                  <div class="row mt-5">
                                    <div class="col-md-6 offset-md-3">
                                        <h4 class="text-center">Ocupaciones principales</h4>
                                        <canvas id="occupationChart"></canvas>
                                    </div>
                                </div>
                                
                                <script>
                                fetch("{% url 'occupations_main' %}")
                                  .then(res => res.json())
                                  .then(data => {
                                    new Chart(document.getElementById('occupationChart'), {
                                      type: 'bar',
                                      data: {
                                        labels: data.labels,
                                        datasets: [{
                                          label: 'Número de usuarios',
                                          data: data.data,
                                          backgroundColor: '#27ae60'
                                        }]
                                      },
                                      options: {
                                        responsive: true,
                                        scales: {
                                          y: {
                                            beginAtZero: true,
                                            title: {
                                              display: true,
                                              text: 'Cantidad'
                                            }
                                          },
                                          x: {
                                            title: {
                                              display: true,
                                              text: 'Ocupación'
                                            }
                                          }
                                        }
                                      }
                                    });
                                  });
                                </script>
                      		</div><!-- /darkblue panel -->
						</div><!-- /col-md-4 -->
						
						
						<div class="col-md-4 mb">
							<!-- INSTAGRAM PANEL -->
							<div class="instagram-panel pn">
								<i class="fa fa-instagram fa-4x"></i>
								<p>@THISISYOU<br/>
									5 min. ago
								</p>
								<p><i class="fa fa-comment"></i> 18 | <i class="fa fa-heart"></i> 49</p>
							</div>
						</div><!-- /col-md-4 -->
						
						<div class="col-md-4 col-sm-4 mb">
							<!-- REVENUE PANEL -->
							<div class="darkblue-panel pn">
								<div class="darkblue-header">
									<h5>REVENUE</h5>
								</div>
								<div class="chart mt">
									<div class="sparkline" data-type="line" data-resize="true" data-height="75" data-width="90%" data-line-width="1" data-line-color="#fff" data-spot-color="#fff" data-fill-color="" data-highlight-line-color="#fff" data-spot-radius="4" data-data="[200,135,667,333,526,996,564,123,890,464,655]"></div>
								</div>
								<p class="mt"><b>$ 17,980</b><br/>Month Income</p>
							</div>
						</div><!-- /col-md-4 -->
						
					</div><!-- /row -->
					
                    <div class="row mt-5">
                        <div class="col-md-12">
                            <h4 class="text-center">Resumen Global: Tecnología vs Tiempo en redes sociales</h4>
                            <div style="max-width: 600px; margin: 0 auto;">
                                <canvas id="summaryChart" style="width: 100%; height: 400px;"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <script>
                    fetch("{% url 'summary_bubble_chart' %}")
                      .then(res => res.json())
                      .then(data => {
                        new Chart(document.getElementById('summaryChart'), {
                          type: 'bubble',
                          data: {
                            datasets: data.datasets
                          },
                          options: {
                            responsive: true,
                            maintainAspectRatio: false, 
                            plugins: {
                              tooltip: {
                                callbacks: {
                                  label: function(context) {
                                    const d = context.raw;
                                    return `${d.label} | Nivel: ${d.x} | Tiempo SM: ${d.y} hrs | Usuarios: ${d.r * 2}`;
                                  }
                                }
                              }
                            },
                            scales: {
                              x: {
                                title: {
                                  display: true,
                                  text: 'Nivel de conocimientos tecnológicos'
                                },
                                beginAtZero: true,
                                max: 10
                              },
                              y: {
                                title: {
                                  display: true,
                                  text: 'Horas diarias en redes sociales'
                                },
                                beginAtZero: true,
                                max: 10
                              }
                            }
                          }
                        });
                      });
                    </script>
                  </div><!-- /col-lg-9 END SECTION MIDDLE -->
              </div><!--/row -->



              <div class="row">
                <div class="col-lg-2">
                    <table>
                        <th>ID</th>
                        <th>NAME</th>
                        <th>PEOPLE</th>
                        {% for x in prefEntre %}
                          <tr>
                            <td>{{ x.entertainment_id }}</td>
                            <td> {{ x.entertainment_name }}</td>
                            <td>{{ x.people }}</td>
                          </tr>
                        {% endfor %}
                    </table>
                </div>
                <div class="col-lg-2">
                    <table>
                        <th>ID</th>
                        <th>NAME</th>
                        <th>SPENT</th>
                        {% for x in spentEntre %}
                          <tr>
                            <td>{{ x.country_id }}</td>
                            <td> {{ x.country_name }}</td>
                            <td>{{ x.total_spent }}</td>
                          </tr>
                        {% endfor %}
                    </table>
                </div>
                <div class="col-lg-2">
                    <table>
                        <th>ID</th>
                        <th>NAME</th>
                        <th>AVG</th>
                        {% for x in gainsPais %}
                          <tr>
                            <td>{{ x.country_id }}</td>
                            <td> {{ x.country_name }}</td>
                            <td>{{ x.avg_income }}</td>
                          </tr>
                        {% endfor %}
                    </table>
                </div>
                <div class="col-lg-2">
                    <table>
                        <th>ID</th>
                        <th>NAME</th>
                        <th>PLATFORM</th>
                        <th>AGE GROUP</th>
                        <th>TOTAL USERS</th>
                        {% for x in edadRsPais %}
                          <tr>
                            <td>{{ x.country_id }}</td>
                            <td> {{ x.country_name }}</td>
                            <td>{{ x.Platform }}</td>
                            <td>{{ x.age_group }}</td>
                            <td>{{ x.total_users }}</td>
                          </tr>
                        {% endfor %}
                    </table>
                </div>
                <div class="col-lg-2">
                    <table>
                        <th>ID</th>
                        <th>NAME</th>
                        <th>TOTAL</th>
                        {% for x in gastoOcupacion %}
                          <tr>
                            <td>{{ x.occupation_id }}</td>
                            <td> {{ x.occupation_name }}</td>
                            <td>{{ x.total_spent }}</td>
                          </tr>
                        {% endfor %}
                    </table>
                </div>
              </div>


          </section>
      </section>
      




      <!--main content end-->
      <!--footer start-->
      <footer class="site-footer">
          <div class="text-center">
              2014 - Alvarez.is
              <a href="index.html#" class="go-top">
                  <i class="fa fa-angle-up"></i>
              </a>
          </div>
      </footer>
      <!--footer end-->
  </section>

    <!-- js placed at the end of the document so the pages load faster -->
    <script src="{% static 'assets/js/jquery.js' %}"></script>
    <script src="{% static 'assets/js/jquery-1.8.3.min.js' %}"></script>
    <script src="{% static 'assets/js/bootstrap.min.js' %}"></script>
    <script class="include" type="text/javascript" src="{% static 'assets/js/jquery.dcjqaccordion.2.7.js' %}"></script>
    <script src="{% static 'assets/js/jquery.scrollTo.min.js' %}"></script>
    <script src="{% static 'assets/js/jquery.nicescroll.js' %}" type="text/javascript"></script>
    <script src="{% static 'assets/js/jquery.sparkline.js' %}"></script>


    <!--common script for all pages-->
    <script src="{% static 'assets/js/common-scripts.js' %}"></script>
    
    <script type="text/javascript" src="{% static 'assets/js/gritter/js/jquery.gritter.js' %}"></script>
    <script type="text/javascript" src="{% static 'assets/js/gritter-conf.js' %}"></script>

    <!--script for this page-->
    <script src="{% static 'assets/js/sparkline-chart.js' %}"></script>    
	<script src="{% static 'assets/js/zabuto_calendar.js' %}"></script>	

    
	
	<script type="text/javascript">
        $(document).ready(function () {
        var unique_id = $.gritter.add({
            // (string | mandatory) the heading of the notification
            title: 'Welcome to Dashgum!',
            // (string | mandatory) the text inside the notification
            text: 'Hover me to enable the Close Button. You can hide the left sidebar clicking on the button next to the logo. Free version for <a href="http://blacktie.co" target="_blank" style="color:#ffd777">BlackTie.co</a>.',
            // (string | optional) the image to display on the left
            image: assets/img/ui-sam.jpg,
            // (bool | optional) if you want it to fade out on its own or just sit there
            sticky: true,
            // (int | optional) the time you want it to be alive for before fading out
            time: '',
            // (string | optional) the class name you want to apply to that specific message
            class_name: 'my-sticky-class'
        });

        return false;
        });
	</script>
	
	<script type="application/javascript">
        $(document).ready(function () {
            $("#date-popover").popover({html: true, trigger: "manual"});
            $("#date-popover").hide();
            $("#date-popover").click(function (e) {
                $(this).hide();
            });
        
            $("#my-calendar").zabuto_calendar({
                action: function () {
                    return myDateFunction(this.id, false);
                },
                action_nav: function () {
                    return myNavFunction(this.id);
                },
                ajax: {
                    url: "show_data.php?action=1",
                    modal: true
                },
                legend: [
                    {type: "text", label: "Special event", badge: "00"},
                    {type: "block", label: "Regular event", }
                ]
            });
        });
        
        
        function myNavFunction(id) {
            $("#date-popover").hide();
            var nav = $("#" + id).data("navigation");
            var to = $("#" + id).data("to");
            console.log('nav ' + nav + ' to: ' + to.month + '/' + to.year);
        }
    </script>
  

  </body>
</html>
